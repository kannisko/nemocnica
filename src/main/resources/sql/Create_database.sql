DROP TABLE DEPARTMENTS CASCADE CONSTRAINTS;
DROP TABLE DOCUMENTATION CASCADE CONSTRAINTS;
DROP TABLE DOCTORS CASCADE CONSTRAINTS;
DROP TABLE PATIENTS CASCADE CONSTRAINTS;
DROP TABLE NURSES CASCADE CONSTRAINTS;
DROP TABLE HOSPITAL_ROOMS CASCADE CONSTRAINTS;
DROP TABLE OPERATING_THEATRE CASCADE CONSTRAINTS;
DROP TABLE emergency_center CASCADE CONSTRAINTS;
purge recyclebin;

CREATE TABLE DOCTORS
(
 doctor_id NUMBER (4) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT Doctor_PK PRIMARY KEY,
 name VARCHAR2(20) NOT NULL,
 surname VARCHAR2(20) NOT NULL,
 med_specialisation VARCHAR2 (20) NOT NULL,
 position VARCHAR2(20) NOT NULL,
 chief_doctor_id NUMBER (4) CONSTRAINT FK_chief_doctor REFERENCES DOCTORS(doctor_id),
 department_id NUMBER (4) NOT NULL,
 salary NUMBER NOT NULL
);

CREATE TABLE NURSES
(
 nurse_id NUMBER (4) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT Nurse_PK PRIMARY KEY,
 name VARCHAR2(20) NOT NULL,
 surname VARCHAR2(20) NOT NULL,
 profession VARCHAR2 (20) NOT NULL,
 chief_nurse_id NUMBER (4) CONSTRAINT FK_chief_nurse REFERENCES NURSES(nurse_id),
 department_id NUMBER (4) NOT NULL,
 salary NUMBER NOT NULL
);

CREATE TABLE DEPARTMENTS
(
  department_id NUMBER (4)  GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT Departments_PK PRIMARY KEY,
  name VARCHAR2(20) NOT NULL,
  chief_doctor_id NUMBER (4) NOT NULL,
  head_nurse_id NUMBER (4) NOT NULL,
  yearly_budget NUMBER NOT NULL,
  CONSTRAINT FK_head_doctor FOREIGN KEY (chief_doctor_id) REFERENCES DOCTORS(doctor_id),
  CONSTRAINT FK_head_nurse FOREIGN KEY (head_nurse_id) REFERENCES NURSES(nurse_id)
);

CREATE TABLE HOSPITAL_ROOMS
(
  room_id NUMBER (4)  GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT Room_PK PRIMARY KEY,
  department_id NUMBER (4) NOT NULL,
  equipment VARCHAR2 (20),
  CONSTRAINT FK_room_department FOREIGN KEY (department_id) REFERENCES DEPARTMENTS(department_id)
);

ALTER TABLE DOCTORS ADD CONSTRAINT FK_workdepartment FOREIGN KEY (Department_id) REFERENCES DEPARTMENTS (department_id);
ALTER TABLE NURSES ADD CONSTRAINT FK_nurse_workdepartment FOREIGN KEY (Department_id) REFERENCES DEPARTMENTS (department_id);

CREATE TABLE PATIENTS
(
  patient_id NUMBER (4) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT patients_PK PRIMARY KEY,
  acceptance_date DATE NOT NULL,
  main_doctor_id NUMBER (4) NOT NULL, 
  CONSTRAINT FK_maindoctor FOREIGN KEY (main_doctor_id) REFERENCES DOCTORS(doctor_id),
  department_id NUMBER (4) NOT NULL,
  CONSTRAINT FK_department FOREIGN KEY (department_id) REFERENCES DEPARTMENTS(department_id),
  nurse_id NUMBER (4) NOT NULL,
  CONSTRAINT FK_mainnurse FOREIGN KEY (nurse_id) REFERENCES NURSES(nurse_id),
  room_id NUMBER (4) NOT NULL CONSTRAINT FK_room REFERENCES HOSPITAL_ROOMS(room_id)
);

CREATE TABLE DOCUMENTATION
(
  patient_id NUMBER (4) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1,
  name VARCHAR2(20) NOT NULL,
  surname VARCHAR2(20) NOT NULL,
  PESEL VARCHAR2(11) CONSTRAINT PESEL_LENGTH CHECK (LENGTH(PESEL)>= 11),
  disease VARCHAR2 (40) NOT NULL,
  PRIMARY KEY (patient_id),
  CONSTRAINT FK_PersonDocumentation FOREIGN KEY (patient_id)
  REFERENCES PATIENTS(patient_id)
);

CREATE TABLE OPERATING_THEATRE
(
    surgery_id  NUMBER (4) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT surgery_PK PRIMARY KEY,
    patient_id NUMBER (4) NOT NULL CONSTRAINT FK_surgery_patient REFERENCES PATIENTS(patient_id),
    surgery_name VARCHAR2(20) NOT NULL,
    doctor_id NUMBER (4) NOT NULL CONSTRAINT FK_surgery_doctor REFERENCES DOCTORS(doctor_id),
    patient_condition VARCHAR2 (20) NOT NULL,
    surgery_date DATE NOT NULL
);

CREATE TABLE emergency_center
(
 ambulance_id number (3) GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 CONSTRAINT ambulance_PK PRIMARY KEY,
 doctor_id NUMBER (4) NOT NULL CONSTRAINT FK_ambulance_doctor REFERENCES DOCTORS(doctor_id),
 nurse_id NUMBER (4) NOT NULL CONSTRAINT FK_paramedic REFERENCES NURSES(nurse_id)

);
